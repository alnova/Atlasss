{% extends 'base.html' %}
{% block yavascript %}
<script type="text/javascript" src="/media/jquery1.9.min.js"></script>
<script type="text/javascript" src="/media/jquery.transit.min.js"></script>
<script type="text/javascript">


var numImages = 0
var imgDataset = []
var maxImages = 48

function drawImages(){
    console.log( imgDataset );
    for( var i = 0; i < imgDataset.length; i++) {
        //$('#img' + i % maxImages).transition({opacity: 0 })
        $('#img' + i ).attr('src',imgDataset[i] );
    }
}
// DATA FUNCTION FOR ASSAILED RESULT
function dataFunction(data)
{
    console.log("In here");
    console.log(" What is data?")
    console.log(data)
    // Append the results to the imgDataset
    for (var i = 0; i < data['images'].length; i++) {
        imgDataset[numImages % maxImages] =  data['images'][i]
        numImages++
    }
    drawImages()
}


function performSearch()
{
	$.ajax({
    	url: etsyURL,
        success: dataFunction
    });
}

wordMemory = ""
// $( "#target" ).
$(document).keypress(function(e) {
    //console.log( e.which )
    var c = String.fromCharCode(e.which)
    //console.log( c )
  if(e.which == 32 ) {
    // console.log( 'space pressed ')
    console.log( wordMemory )
    if ( wordMemory.length > 3 ) {
        etsyURL = "../atlas/model/" + wordMemory + "/"
        console.log( etsyURL);
        performSearch();
    }
    wordMemory = ""
  } else {
    wordMemory = wordMemory + c
  }
});

(function($){
    $(document).ready(function(){

        for (var i = 0; i < maxImages; i++ ) {
         $('#img'+i).each(function() {
            $(this).attr('src', imgDataset[i]);
         });
         $('#img'+i).transition({ opacity: 1, delay:  (i % 6) * 1000+(Math.random()*1000) })
         .transition( {scale: 0.5, delay:  (i % 6) * 100+(Math.random()*1000) })
         .transition( {scale: 1, delay:  (i % 6) * 100+(Math.random()*1000) })

        }

        $('.varimg').each(function() {
            $(this).attr('src','images/'+$(this).prev().text()+'.jpg');
        });

        window.setInterval(animationsLoop, 30000);

        function animationsLoop() {
            for (var i = 0; i < maxImages; i++ ) {
                $('#img'+i).transition({opacity: 0, delay:500*(i%6) })
                             .transition({opacity: 1, delay:500*(i%6)+3000 })
            }
    }
})
 } ) (jQuery);






</script>

{% endblock %}


















{% block css %}
<style type="text/css">
	html {
		margin:0;
		padding:0;
		color:#000;
	}
	body{
		background-color: #FFFFFF;
	}
    #page {
        margin-left: auto;
        margin-right: auto;
    }
    textarea {
        font: 20px serif;
        width: 99%;
        height: 99%;
        margin-left: auto;
        margin-right: auto;
        border-style: solid;
        border-color: #000055;
        border-width: 1px;/*
        border: none;
        outline: none;
        border-style: none;
        border-color: Transparent;*/
        /*overflow: auto;
        position: relative;
        top: -174px;*/
    }
    label {
        display: none;
    }
    .spectrum {
        opacity: 0;
        width:83px;
        height:83px;
        margin-bottom: 5px;
    }
     </style>
{% endblock %}





{% block content %}
<div class="container-fluid">
    <div class="row">
    {% for image in imageList %}
    {% if forloop.counter0|divisibleby:6 %}

        {% if forloop.counter0 == 24 %}
        <div class="col-md-4">
            {% if user.is_authenticated %}
            Hello {{ user.username }}, please write a short story.
            <form action="/atlas/sign" method="post">{% csrf_token %}
             <p>{{ form }}</p>
            <input type="submit" value="Save Page" />
            </form>
            {% else %}
            <h1>Welcome to a user study.</h1>
            <small><a href="/accounts/create_user/">Create User</a> to get started.</small>
            {% endif %}
        </div>
        <div class="col-md-1">
        <img id='img{{ forloop.counter0 }}' src="{{ image }}" alt="..." class="img-thumbnail spectrum">
        {% else %}
        <div class="col-md-1">
        <img id='img{{ forloop.counter0 }}' src="{{ image }}" alt="..." class="img-thumbnail spectrum">
        {% endif %}
    {% else %}
        {% if forloop.counter0 == 5 or forloop.counter0 == 11 or forloop.counter0 == 17 or forloop.counter0 == 23 or forloop.counter0 == 29 or forloop.counter0 == 35 or forloop.counter0 == 41 or forloop.counter0 == 47  %}
        <img id='img{{ forloop.counter0 }}' src="{{ image }}" alt="..." class="img-thumbnail spectrum">
        </div>
        {% else %}
        <img id='img{{ forloop.counter0 }}' src="{{ image }}" alt="..." class="img-thumbnail spectrum">
        {% endif %}
    {% endif %}
    {% endfor %}
</div>
</div>

{% endblock %}
